<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Program 5</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.1.2/handlebars.min.js"></script>
</head>
<body>
<h1>Select a Major</h1>
<p>We filter our database by a student's major.</p>
<button type="button" id="CITmajor" onClick="showDate('CIT')">CIT Majors</button>
<button type="button" id="BUSmajor" onClick="showData('BUS')">Business Majors</button>
<div id="myTable"></div>
</body>

<!-- Handlebar template -->
<script type="text/x-handlebars-template" id="Template">
<table>
<tr><th>Name</th><th>Major</th><th>Midterm</th><th>Final</th></tr>
	{{#each rows}}
		<tr>
			<td>{{name}}</td><td>{{major}}</td><td>{{midterm}}</td><td>{{final}}</td>
		</tr>
	{{/each}}
</table>
</script>

<script>
async function showData(select_major) {
	var response = await fetch('cit5students.json');
	
	if(response.ok){
		var studentData = await response.json();
		students = studentData.filter( (student) => student.major == select_major);
		
		var templateText = document.getElementByID('myTable').innerHTML;
		var compiledTemplateText = Handlebars.compile(templateText);
		compiledHtml = compiledTemplateText({rows: students});
		document.getElementById('myTable').innerHTML = compiledHtml;
	}
	else {
		document.querySelector('#myTable').innerHTML = "I'm sorry. There was an error and we can't find any students with the major you selected.";
	}
}
</script>


</html>
